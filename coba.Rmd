library(tidyverse)
# define file from my github
urlfile = "https://github.com//zia207/r-colab/raw/main/Data/USA/gp_soil_data.csv"
mf<-read_csv(url(urlfile))

# Create  data-frames
X<-mf %>% dplyr::select( DEM, Aspect, Slope,TPI) %>%
  scale()

Y<-mf %>% dplyr::select(MAT, MAP, NDVI) %>%
  scale()
  
cc <- cancor(X,Y)
str(cc)
print(cc)
cc$cor

CC1_X <- as.matrix(X) %*% cc$xcoef[, 1]
CC1_Y <- as.matrix(Y) %*% cc$ycoef[, 1]
CC2_X <- as.matrix(X) %*% cc$xcoef[, 2]
CC2_Y <- as.matrix(Y) %*% cc$ycoef

cca_df <- mf %>% 
  mutate(CC1_X=CC1_X,
         CC1_Y=CC1_Y,
         CC2_X=CC2_X,
         CC2_Y=CC2_Y) %>%
  glimpse()